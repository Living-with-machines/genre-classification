
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sample Inspector (Part I) &#8212; Classifying 19th Century British Library books using Crowdsourcing and Machine Learning</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sample Inspector (Part II)" href="sample_inspector_ii.html" />
    <link rel="prev" title="Crude Genre Classification" href="00_crude_genre.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Classifying 19th Century British Library books using Crowdsourcing and Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Genre Classification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="zooniverse.html">
   Overview of the Project: Classifying British Library Books By Genre
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="genre_classification.html">
   Genre Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="00_crude_genre.html">
   Crude Genre Classification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exploratory Data Analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Sample Inspector (Part I)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sample_inspector_ii.html">
   Sample Inspector (Part II)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Training our first model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_BL_fiction_non_fiction.html">
   Training our first book genre classification model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01b_inference.html">
   Model inference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assesing our models performance
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01b_improving_results.html">
   Improving our model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_error_analysis.html">
   Assessing Where our Model is Going Wrong
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Improving our model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="04_snorkel.html">
   Creating More Training Data Without More Annotating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_using_our_new_data.html">
   Using our newly expanded data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04a_fastai.html">
   Fine tuning our fastai model with new data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04b_transformer.html">
   Using a Transformer Based Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sharing our results and final inference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="05_share_outputs.html">
   Sharing our work
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_pipeline_inference.html">
   Using our new Hugging Face model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Further resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="other_resources.html">
   Other resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glossary.html">
   Glossary
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/sample_inspector_i.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/sample_inspector_i.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/sample_inspector_i.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#looking-at-keywords-over-time">
   Looking at keywords over time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-data">
   Loading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parsing-all-of-the-titles-for-a-year">
   Parsing all of the titles for a year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-catalogue-metadata">
   Loading catalogue metadata
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parsing-date-ranges">
     Parsing date ranges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-our-corpus-to-a-wider-collection">
     Comparing our corpus to a wider collection
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="sample-inspector-part-i">
<h1>Sample Inspector (Part I)<a class="headerlink" href="#sample-inspector-part-i" title="Permalink to this headline">¶</a></h1>
<div class="section" id="looking-at-keywords-over-time">
<h2>Looking at keywords over time<a class="headerlink" href="#looking-at-keywords-over-time" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, we investigate how the digital sample compares to the ‘universe’ of book publications in the 19th century. Even though the Microsoft Digitised Books corpus is a rich collection, it remains unclear what is in there and what’s not. Especially when one is interested in a specific topic, like ‘machines’, knowing what content we don’t have digital access to is critical if we want to make sense and of findings built on such digital resources.</p>
<p>To understand the digital sample to the population of printed works, we compare the keywords in titles between these two levels. We show how to load and process data in Pandas, build a quick and efficient method to gauge and visualize the presence of a set of selected keywords in book titles over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we need import all libraries and tools required in the rest of this notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-the-data">
<h2>Loading the data<a class="headerlink" href="#loading-the-data" title="Permalink to this headline">¶</a></h2>
<p>Using Pandas, we load the metadata on the BL books collection and print the first three rows for inspection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_blb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://bl.iro.bl.uk/downloads/e1be1324-8b1a-4712-96a7-783ac209ddef?locale=en&quot;</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BL record ID&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">metadata_blb</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BL record ID</th>
      <th>Type of resource</th>
      <th>Name</th>
      <th>Dates associated with name</th>
      <th>Type of name</th>
      <th>Role</th>
      <th>All names</th>
      <th>Title</th>
      <th>Variant titles</th>
      <th>Series title</th>
      <th>...</th>
      <th>Date of publication</th>
      <th>Edition</th>
      <th>Physical description</th>
      <th>Dewey classification</th>
      <th>BL shelfmark</th>
      <th>Topics</th>
      <th>Genre</th>
      <th>Languages</th>
      <th>Notes</th>
      <th>BL record ID for physical resource</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>014602826</td>
      <td>Monograph</td>
      <td>Yearsley, Ann</td>
      <td>1753-1806</td>
      <td>person</td>
      <td>NaN</td>
      <td>More, Hannah, 1745-1833 [person] ; Yearsley, A...</td>
      <td>Poems on several occasions [With a prefatory l...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1786</td>
      <td>Fourth edition MANUSCRIPT note</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Digital Store 11644.d.32</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>English</td>
      <td>NaN</td>
      <td>3996603</td>
    </tr>
    <tr>
      <th>1</th>
      <td>014602830</td>
      <td>Monograph</td>
      <td>A, T.</td>
      <td>NaN</td>
      <td>person</td>
      <td>NaN</td>
      <td>Oldham, John, 1653-1683 [person] ; A, T. [person]</td>
      <td>A Satyr against Vertue. (A poem: supposed to b...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1679</td>
      <td>NaN</td>
      <td>15 pages (4°)</td>
      <td>NaN</td>
      <td>Digital Store 11602.ee.10. (2.)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>English</td>
      <td>NaN</td>
      <td>1143</td>
    </tr>
    <tr>
      <th>2</th>
      <td>014602831</td>
      <td>Monograph</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>The Aeronaut, a poem; founded almost entirely,...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1816</td>
      <td>NaN</td>
      <td>17 pages (8°)</td>
      <td>NaN</td>
      <td>Digital Store 992.i.12. (3.)</td>
      <td>Dublin (Ireland)</td>
      <td>NaN</td>
      <td>English</td>
      <td>NaN</td>
      <td>22782</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 24 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="parsing-all-of-the-titles-for-a-year">
<h2>Parsing all of the titles for a year<a class="headerlink" href="#parsing-all-of-the-titles-for-a-year" title="Permalink to this headline">¶</a></h2>
<p>Next, we process the titles in this dataframe: we create a <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> object in which we map a year to a long string that contains all the titles of books published in that year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert all titles to a string</span>
<span class="n">metadata_blb</span><span class="p">[</span><span class="s2">&quot;title_str&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_blb</span><span class="o">.</span><span class="n">Title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]))</span>
<span class="c1"># in case of a date range select the first year</span>
<span class="n">metadata_blb</span><span class="p">[</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_blb</span><span class="p">[</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># group all titles by year, i.e. for each year we concatenate all titles as one long string</span>
<span class="n">titles_by_year_bl</span> <span class="o">=</span> <span class="n">metadata_blb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">)[</span><span class="s2">&quot;title_str&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span>
<span class="p">)</span>
<span class="c1"># slice the Series to retain only titles that fall within the target period</span>
<span class="n">titles_by_year_bl</span> <span class="o">=</span> <span class="n">titles_by_year_bl</span><span class="p">[</span><span class="s2">&quot;1800&quot;</span><span class="p">:</span><span class="s2">&quot;1899&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>These operations return a variable <code class="docutils literal notranslate"><span class="pre">titles_by_year_bl</span></code> of type <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> in which the index refers to the year of publication and the values are a concatenation of all titles</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titles_by_year_bl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date of publication
1800    Egbert; or, The Suicide. A tale [In verse.] So...
1801    The Old Hag in a Red Cloak. A romance [In vers...
1802    Elegy to the memory of the late Duke of Bedfor...
1803    [Britons strike home.] Songs &amp;c. in Britons st...
1804    The Sports of the Genii [Etchings from drawing...
                              ...                        
1895    A Few Verses The Ghais o&#39; Dennilair: a legend ...
1896    Book of Word &amp; Music of Humorous Songs, Burles...
1897    Altenglische Spruchweisheit, alt- und mittelen...
1898    A Vision. (Penny edition.) The Ballad of the W...
1899    Hawthorn and Lavender: songs and madrigals We ...
Name: title_str, Length: 100, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titles_by_year_bl</span><span class="p">[</span><span class="s2">&quot;1800&quot;</span><span class="p">][:</span><span class="mi">200</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Egbert; or, The Suicide. A tale [In verse.] Songs, Chorusses, etc, in the new pantomime of Harlequin Tour; or, the Dominion of Fancy, as performed at the Theatre Royal, Covent-Garden, etc A Journey to&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-catalogue-metadata">
<h2>Loading catalogue metadata<a class="headerlink" href="#loading-catalogue-metadata" title="Permalink to this headline">¶</a></h2>
<p>Then we load a .csv file which contains an export of the British Library Catalogue. For sure, the BL catalogue won’t give us a complete list of all books in the 19th century, but at least it is converging to the universe of known printed works in this period. As a comparison and contextualisation tool, it helps us understand the contours and composition of the digital collection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://bl.iro.bl.uk/downloads/e4bf0f74-2c64-4322-93c7-0dcc5e5246da?locale=en&quot;</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BL record ID&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">metadata_cat</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3296: DtypeWarning: Columns (2,3,19) have mixed types.Specify dtype option on import or set low_memory=False.
  exec(code_obj, self.user_global_ns, self.user_ns)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BL record ID</th>
      <th>Type of resource</th>
      <th>BNB number</th>
      <th>ISBN</th>
      <th>Name</th>
      <th>Dates associated with name</th>
      <th>Type of name</th>
      <th>Role</th>
      <th>All names</th>
      <th>Title</th>
      <th>...</th>
      <th>Publisher</th>
      <th>Date of publication</th>
      <th>Edition</th>
      <th>Physical description</th>
      <th>Dewey classification</th>
      <th>BL shelfmark</th>
      <th>Topics</th>
      <th>Genre</th>
      <th>Languages</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000000004</td>
      <td>Monograph</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Carlbohm, Johan Arvid, printer [person]</td>
      <td>Aabc [etc.] Jesus Vocales, eli äänelliset boks...</td>
      <td>...</td>
      <td>präntätty directörin J.A. Carlbohmin tykönä</td>
      <td>1800</td>
      <td>NaN</td>
      <td>16 unnumbered pages, 17 cm (8°)</td>
      <td>NaN</td>
      <td>12976.aa.3</td>
      <td>Writing ; Reading ; Writing--Alphabets--Primer...</td>
      <td>NaN</td>
      <td>Finnish</td>
      <td>Finnish primer, beginning with the Lord's pray...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000000006</td>
      <td>Monograph</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A che serve il Papa?</td>
      <td>...</td>
      <td>Tiberina</td>
      <td>1889</td>
      <td>NaN</td>
      <td>32 pages, 14 cm</td>
      <td>NaN</td>
      <td>3900.aaa.20. (4.)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Italian</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000000007</td>
      <td>Monograph</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A. for Apple [An illustrated alphabet.]</td>
      <td>...</td>
      <td>Ward &amp; Lock</td>
      <td>1894</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12811.h.70</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 25 columns</p>
</div></div></div>
</div>
<div class="section" id="parsing-date-ranges">
<h3>Parsing date ranges<a class="headerlink" href="#parsing-date-ranges" title="Permalink to this headline">¶</a></h3>
<p>Values in the <code class="docutils literal notranslate"><span class="pre">'Date</span> <span class="pre">of</span> <span class="pre">publication'</span></code> column sometimes refer to a date range instead of a specific year. To simplify things, we take the first year as the date of publication. Admittedly, this choice is questionable, and we encourage that you craft other solutions depending on your research interests.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_cat</span><span class="p">[</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;1800&#39;, &#39;1889&#39;, &#39;1894&#39;, ..., &#39;1855-1875&#39;, &#39;1887-1937&#39;, &#39;1893-1963&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_cat</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_cat</span><span class="p">[</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also do the same for the BL Books collection</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_blb</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_blb</span><span class="p">[</span><span class="s2">&quot;Date of publication&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With its 5.1 billion tokens and close to 50k titles, the Microsoft Digitised Books is an impressive collection. However, it constitutes just 2.73% of all books printed in the 19th century. As a historian, the amount of information seems overwhelming, but one should realise it is still a small empirical basis when making claims about cultural evolution in the 19th century.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_19thc_books_bl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">metadata_blb</span><span class="p">[(</span><span class="n">metadata_blb</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="s2">&quot;1800&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metadata_blb</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="s2">&quot;1900&quot;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">num_19thc_books_cat</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
    <span class="n">metadata_cat</span><span class="p">[(</span><span class="n">metadata_cat</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="s2">&quot;1800&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metadata_cat</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="s2">&quot;1900&quot;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of 19thC works in the BL Books collection: &quot;</span><span class="p">,</span> <span class="n">num_19thc_books_bl</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of 19thC works in the Catologue: &quot;</span><span class="p">,</span> <span class="n">num_19thc_books_cat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The sample size is&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">num_19thc_books_bl</span> <span class="o">/</span> <span class="n">num_19thc_books_cat</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of 19thC works in the BL Books collection:  46518
Number of 19thC works in the Catologue:  1686158
The sample size is 2.76 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comparing-our-corpus-to-a-wider-collection">
<h3>Comparing our corpus to a wider collection<a class="headerlink" href="#comparing-our-corpus-to-a-wider-collection" title="Permalink to this headline">¶</a></h3>
<p>Similar to what we did with BL Books metadata, we concatenate titles in the catalogue to one long string, one per year, and slice the <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata_cat</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_cat</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="nb">str</span>
<span class="p">)</span>  <span class="c1"># convert all titles to strings</span>
<span class="n">titles_by_year_cat</span> <span class="o">=</span> <span class="n">metadata_cat</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span>
<span class="p">)</span>  <span class="c1"># group titles by year and join as one long string</span>
<span class="n">titles_by_year_cat</span> <span class="o">=</span> <span class="n">titles_by_year_cat</span><span class="p">[</span><span class="s2">&quot;1800&quot;</span><span class="p">:</span><span class="s2">&quot;1899&quot;</span><span class="p">]</span>  <span class="c1"># slice the series</span>
</pre></div>
</div>
</div>
</div>
<p>We established that the digital corpus constitutes only 2.76% of the population. To assess changes over time, we can visualize the sample size (as a percentage of the population) for each year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">metadata_cat</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">&quot;1800&quot;</span><span class="p">:</span><span class="s2">&quot;1900&quot;</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">metadata_blb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="s2">&quot;title_str&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">&quot;1800&quot;</span><span class="p">:</span><span class="s2">&quot;1900&quot;</span><span class="p">]</span>
<span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x159360110&gt;
</pre></div>
</div>
<img alt="_images/sample_inspector_i_25_1.png" src="_images/sample_inspector_i_25_1.png" />
</div>
</div>
<p>In the cells below, we turn to analysing and comparing the content of the titles. We repeat the following steps for both the BL Books metadata and catalogue information.</p>
<ul class="simple">
<li><p>We create a document-term matrix, where each row comprises the word counts for all titles in a specific year</p></li>
<li><p>We compute the total word counts per year</p></li>
</ul>
<p>We use the <code class="docutils literal notranslate"><span class="pre">CountVectorizer</span></code> object provided by <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> which takes a list of texts as input and converts this to a document-term matrix. The <code class="docutils literal notranslate"><span class="pre">min_df</span></code> argument allows us to discard words that only appear once, thus avoiding that the matrix becomes too large.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bl_counts</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># create a CountVectorizer object</span>
<span class="n">bl_dtm</span> <span class="o">=</span> <span class="n">bl_counts</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
    <span class="n">titles_by_year_bl</span>
<span class="p">)</span>  <span class="c1"># fit the CountVectorizer on the titles</span>
<span class="n">totals_bl</span> <span class="o">=</span> <span class="n">bl_dtm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># sum row wise, i.e. totals for each year</span>
<span class="n">totals_bl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals_bl</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_counts</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cat_dtm</span> <span class="o">=</span> <span class="n">cat_counts</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">titles_by_year_cat</span><span class="p">)</span>
<span class="n">totals_cat</span> <span class="o">=</span> <span class="n">cat_dtm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">totals_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">totals_cat</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>By amending the <code class="docutils literal notranslate"><span class="pre">terms</span></code> variable you can select the keywords you want to investigate and compare between sample and population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;machinery&quot;</span><span class="p">,</span> <span class="s2">&quot;machines&quot;</span><span class="p">,</span> <span class="s2">&quot;machine&quot;</span><span class="p">,</span> <span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="s2">&quot;engines&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terms_bl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bl_counts</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Plotting relative frequency for following words in BL Books titles:</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">terms_bl</span>
<span class="p">)</span>
<span class="n">terms_cat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cat_counts</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Plotting relative frequency for following words in BL Catalogue titles:</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">terms_cat</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plotting relative frequency for following words in BL Books titles:
	 [&#39;machinery&#39;, &#39;machines&#39;, &#39;engines&#39;]

Plotting relative frequency for following words in BL Catalogue titles:
	 [&#39;machine&#39;, &#39;machines&#39;, &#39;engines&#39;, &#39;machinery&#39;, &#39;engine&#39;]
</pre></div>
</div>
</div>
</div>
<p>In the code cell below, we first collect frequencies of the given query terms in the BL Books corpus (and sum all counts if more than one keyword is given). We divide the yearly absolute counts by the total number of words in titles to obtain yearly relative frequencies. We repeat the same procedure for the catalogue data.</p>
<p>Lastly, we plot the relative frequencies for both the BL Books (blue) and catalogue (orange), slight smoothing the timeline by showing the rolling mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_bl</span> <span class="o">=</span> <span class="p">[</span><span class="n">bl_counts</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms_bl</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_bl</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">counts_bl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">bl_dtm</span><span class="p">[:,</span> <span class="n">idx_bl</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">counts_bl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">bl_dtm</span><span class="p">[:,</span> <span class="n">idx_bl</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">counts_bl</span> <span class="o">/</span> <span class="n">totals_bl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">titles_by_year_bl</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">idx_cat</span> <span class="o">=</span> <span class="p">[</span><span class="n">cat_counts</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms_cat</span><span class="p">]</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_cat</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">counts_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">cat_dtm</span><span class="p">[:,</span> <span class="n">idx_cat</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">counts_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">cat_dtm</span><span class="p">[:,</span> <span class="n">idx_cat</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">counts_cat</span> <span class="o">/</span> <span class="n">totals_cat</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x162b24590&gt;
</pre></div>
</div>
<img alt="_images/sample_inspector_i_33_1.png" src="_images/sample_inspector_i_33_1.png" />
</div>
</div>
<p>## Fin.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="00_crude_genre.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Crude Genre Classification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="sample_inspector_ii.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sample Inspector (Part II)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Daniel van Strien, Giorgia Tolfo, Victoria Morris, Kaspar Beelen<br/>
        
            &copy; Copyright 2021 The Alan Turing Institute, British Library Board, Queen Mary University of London, University of Exeter, University of East Anglia and University of Cambridge..<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>